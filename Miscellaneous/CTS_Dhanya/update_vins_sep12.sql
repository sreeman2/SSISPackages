SELECT * FROM WORKTEMP.DBO.PORSCHE_VINS_DW

SELECT *
  FROM PESDW.DBO.PES_DW_VIN (NOLOCK)
WHERE BILL_NUMBER = 'NWGJ2697074'

SELECT * 
 FROM PESDW.DBO.PES_DW_CMD (NOLOCK)
WHERE BOL_ID = 252717948

SELECT * 
 FROM PESDW.DBO.PES_DW_BOL (NOLOCK)
WHERE BOL_ID = 252717948



-- DW 
SELECT *
  FROM PESDW.DBO.PES_DW_VIN (NOLOCK)
WHERE BILL_NUMBER IN 
(
'GZ07BABR0004',
'AS059NGO5047',
'AS059YOK5050',
'MM002YOK5062',
'PHX219233700',
'GZ07BALH0007',
'MSCUMC990423',
'6062747059',
'NWGJ2697074',
'NWGJ2697074',
'MSCUAR012152',
'S306429776',
'S306379947',
'PHX223061100',
'MIA051919',
'MSCUMC967421',
'S306376038') 
AND VIN_NUMBER IN
(
'WP0AB0912GS120648',
'WP0AA2A76LB019954',
'WP1AD29P88LA72897',
'WP0AB29088S740081',
'WP1AA2A29CLA06230',
'WP0CB2981YU553268',
'4JGBB8G89BA673452',
'4JGBF2FE6CA795277',
'4JGDA5GBXCA064767',
'4JGDA5HB7CA075678',
'4JGQA5HB3CA072144',
'WDDGP8BB5BR149678',
'WDDGP8BB9BR141826',
'WDDHFBHB4BA349994',
'WDDL17DB6CA051277',
'WDDLJ98BXCA036392',
'WDDLJ9EB1CA037639'
)

BEGIN TRAN

/* UPDATING THE DW CMD TABLE */

UPDATE  DWCMD
SET DWCMD.MODIFY_DATE=GETDATE()
--SELECT DWCMD.*
FROM PESDW.DBO.PES_DW_CMD  DWCMD (NOLOCK) WHERE DWCMD.BOL_ID IN 
(SELECT BOL_ID FROM WORKTEMP.DBO.PORSCHE_VINS_DW  WITH (NOLOCK))
AND ISNULL(DWCMD.DELETED,'') <> 'Y'

/* UPDATING THE DW BOL TABLE */
UPDATE  DW
SET DW.MODIFY_DATE=GETDATE()
--SELECT *
FROM PESDW.DBO.PES_DW_BOL  DW  WHERE DW.BOL_ID IN 
(SELECT BOL_ID FROM WORKTEMP.DBO.PORSCHE_VINS_DW  WITH (NOLOCK))

/* UPDATING THE DW VIN TABLE */

UPDATE DWVIN 
  SET VIN_NUMBER = PORSCHE.CORRECT_VIN,MODIFIED_DT = GETDATE(),MODIFIED_BY = USER
-- SELECT DWVIN.BILL_NUMBER,DWVIN.VIN_NUMBER , PORSCHE.WRONG_VIN_NBR,PORSCHE.CORRECT_VIN
FROM PESDW.DBO.PES_DW_VIN DWVIN,WORKTEMP.DBO.PORSCHE_NEW PORSCHE
WHERE DWVIN.BOL_ID = PORSCHE.BOL_ID
  AND DWVIN.VIN_NUMBER  = PORSCHE.WRONG_VIN_NBR
  AND DWVIN.BOL_ID <> 252717948

COMMIT TRAN

select * from PESDW.DBO.PES_DW_VIN where bol_id = 252717948
and vin_number = '4JGDA5GBXCA064767'

update PESDW.DBO.PES_DW_VIN 
set VIN_NUMBER = '4JGDA5HB6CA070467',MODIFIED_DT = GETDATE(),MODIFIED_BY = USER 
where bol_id = 252717948 and vin_number = '4JGDA5GBXCA064767'

select * from PESDW.DBO.PES_DW_VIN (nolock) where vin_number = '4JGDA5GBXCA064767'
select * from PESDW.DBO.PES_DW_VIN (nolock) where bol_id = 252717948


select * from WORKTEMP.DBO.PORSCHE_NEW where bol_id = 252717948






SELECT BOL_ID,COUNT(CORRECT_VIN)
FROM WORKTEMP.DBO.PORSCHE_NEW
GROUP BY BOL_ID

SELECT * FROM PESDW.DBO.PES_DW_VIN WHERE BOL_ID = 252717948 AND BILL_NUMBER = 'NWGJ2697074'
and vin_number = '4JGDA5HB7CA075678'
SELECT * FROM WORKTEMP.DBO.PORSCHE_NEW WHERE BOL_ID = 252717948





SELECT BOL_ID,PORSCHE.*  INTO WORKTEMP.DBO.PORSCHE_NEW
FROM PES_DW_BOL,[10.31.18.132].TEMP_PES.DBO.PORSCHE PORSCHE
WHERE PES_DW_BOL.BILL_NUMBER = PORSCHE.BOL_NBR






 