SELECT distinct vessel_name,BOL_NUMBER,bol_id into #temp 
FROM ARCHIVE_RAW_BOL (NOLOCK)
WHERE BOL_NUMBER IN
(
'16500176021',
'16500176024',
'16500176113',
'16500176113',
'16500176113',
'16500176134',
'16500176139',
'16500176181',
'16500176190',
'16500176262',
'16500176283',
'2K0IENSBP001',
'8006781110',
'8006787160',
'8006793030',
'CHPA2754259',
'CHWB2754268',
'GACO2751076',
'GACO2753596',
'GACR2751249',
'GAWB2751901',
'GAWB2752714',
'GAWB2754443',
'LOWB2753718',
'LOWB2754586',
'MHCO2752867',
'NCWB2751440',
'SCWB2754604',
'SCWB2754615')

select * from ref_vessel (nolock) 
where name in
(
'ALVSBORG BRIDGE',
'APL INDONESIA'
)
and deleted = 'N'


SELECT vessel_ref_id,VESSEL_NAME,* FROM PES_STG_BOL (NOLOCK)
WHERE BOL_NBR IN
(
'16500176021',
'16500176024',
'16500176113',
'16500176113',
'16500176113',
'16500176134',
'16500176139',
'16500176181',
'16500176190',
'16500176262',
'16500176283',
'2K0IENSBP001',
'8006781110',
'8006787160',
'8006793030',
'CHPA2754259',
'CHWB2754268',
'GACO2751076',
'GACO2753596',
'GACR2751249',
'GAWB2751901',
'GAWB2752714',
'GAWB2754443',
'LOWB2753718',
'LOWB2754586',
'MHCO2752867',
'NCWB2751440',
'SCWB2754604',
'SCWB2754615')

BEGIN TRAN

-- 3 
-- UPDATE BLANK VESSELS
--UPDATE PES_STG_BOL  
SET VESSEL_REF_ID = 236108,modify_date = getdate()
FROM #TEMP TMP,PES_STG_BOL stg where
TMP.BOL_ID = STG.BOL_ID
AND TMP.VESSEL_NAME = 'ALVSBORG BRIDGE'

UPDATE PES_STG_BOL  
SET VESSEL_REF_ID = 401532,modify_date = getdate()
FROM #TEMP TMP,PES_STG_BOL stg where
TMP.BOL_ID = STG.BOL_ID
AND TMP.VESSEL_NAME = 'APL INDONESIA'

update pes_stg_cmd set modify_date = getdate()
where bol_id in (select bol_id from #TEMP)

commit tran







